% !TEX root = ../main.tex

\chapter{Blockchain (D. Marazzina)}

A blockchain is a \textbf{DL} (Distributed Ledger\footnote{in Italian: \textit{libro mastro}.}) where data are replicated, shared, and synchronized all over the world. \textbf{No one is the owner}. Any involved block cannot be altered retroactively, without the alteration of all the subsequent blocks. Blocks are connected in a chain.
\begin{itemize}
	\item \textbf{Trust} is not required in the blockchain;
	\item It is required in Dropbox, Google Drive, etc.
\end{itemize}

What happens if a node (by mistake or not) propagates an \textbf{incorrect transaction}? The system must not validate it. How? Through a \textbf{consensus mechanism}.

The problem of the \textbf{Byzantine generals} is a computer problem on how to reach consensus in situations where errors are possible. The problem consists of finding an agreement, communicating only through messages, between different components of conflicting information.

\fg{0.7}{55d25ddfe4b1fb3b630a4242136cf307-RJJ0KnWjoZ-image}

\section{Bitcoin}

Bitcoin is an electronic currency created in 2009 following the famouse paper\footnote{\url{https://bitcoin.org/bitcoin.pdf}} published in November 2008 by the inventor known under the pseudonym of \textbf{Satoshi Nakamoto}.

Keywords:
\begin{itemize}
	\item Consensus mechanism for lack of trust
	\item Decentralized database
	\item Cryptography
	\item Generation of new money
\end{itemize}

\section{Decentralization}

\begin{itemize}
	\item Politically decentralized: Bitcoin is not controlled by a specific entity.
	\item Architecturally decentralized (or distributed): Bitcoin lives on machines spread across the planet.
	\item Logically centralized: all machines that Bitcoin lives on agree on a shared status (e.g. how many Bitcoins each has).
\end{itemize}

A blockchain is a distributed (or architecturally decentralized) and politically decentralized database managed by a peer-to-peer network through distributed consensus mechanisms (to agree on a shared state, as logically centralized).\footnote{Visit this website to explore it! \url{https://www.blockchain.com/explorer}}
\begin{itemize}
	\item A \textbf{transaction} is a Bitcoin transfer that is included in the Blockchain. A transaction is identified by the two addresses (counterparts) and by the amount exchanged. The cryptographic private key signature of the two counterparts provides \textbf{proof of their identity} and that the Bitcoins come from the real owner. The signature also \textbf{prevents that the transaction (once executed) is altered} by others. The two addresses are publicly identified by a code.
\end{itemize}

\fg{0.7}{b5a948c1859f2826ea6b5ac0d3a83474-Pmg6G5phwe-image}

\begin{itemize}
	\item A \textbf{block} is a part of the Blockchain that contains a set of (Bitcoin) transactions. On average, a new block, which includes transactions, is added to the Blockchain every $10$ minutes (the system is tuned to make so happen).
	\item \textbf{Confirmation:} to be included in a block, and therefore in the Blockchain, a transaction must be confirmed by several nodes (\textbf{miners}), i.e. processed by the network.
	\item \textbf{Mining:} it is a mathematical process performed by the Blockchain nodes on the candidate block: once solved the block (and therefore all the transactions recorded in it) is confirmed and inserted into a block of the Blockchain. As a reward for their service, miners receive newly created Bitcoins (and the transaction fees). Mining $1$ new block now makes you earn $6.25$ BTC, mining can be done with ad hoc hardware and consumes a lot of energy.
	      
	      Miners accumulate transactions all the time (selecting them with a certain criterion, such as those that offer the highest fees). When they have enough transactions to fill a block (which has a fixed size) they try to solve the mining problem. The first miner that solves the mining problem propagates the block in the network, which is verified (they verify if the \textit{Proof of Work} is valid) by the other nodes and added to their copy of the blockchain.
\end{itemize}

\fg{0.7}{804e766ecde2775d6efff4a980e6a2ab-b0x52ZU7IL-image}

\begin{itemize}
	\item \textbf{Cryptographic signature}: it is a mathematical mechanism that allows you to prove the identity and ownership of Bitcoins in this case.
	      
	      When your Bitcoin software marks a transaction with your private key, the entire network can recognize you (not as an individual but as an id) and verify that the Bitcoins spent are in your possession. The transaction becomes public with respect to your code. There is currently no way for other nodes to guess your private key, to steal your Bitcoins.
\end{itemize}

\fg{0.7}{6133e4c47407f4c52e44ce591f19e7c7-bAzikty36C-anatomy_of_a_transaction}

\section{Asymmetric (or public key) encryption}

\begin{itemize}
	\item Step 1: a public-private key pair is generated for Alice
	\item Step 2: Bob uses Alice's public key to encrypt the message. Only those who have Alice's private key can decrypt it!
\end{itemize}

So, if Alice has kept the private key hidden, only she can read the message

\fg{0.7}{5094767bdd40d5f5696a43c1da84a0ad-1TwKZy3l5S-image}

Among the asymmetric cryptographies, Bitcoin uses \textbf{Elliptical Cryptography}.

Public keys are based on the creation of a mathematical problem that is very difficult to solve without information, but which - with the use of some information (the private key) - becomes easy and quick to solve. The user publicly distributes the problem (the public key) and keeps the additional information hidden (the private key).

\textit{An example: RSA encryption.}

Let's take two prime numbers, \texttt{13} and \texttt{7} (and don't reveal them to anyone).

Let's multiply them together: we get \texttt{n=91}.

We choose a public key: \texttt{5}.

We use the \textit{Extended Euclidean Algorithm} with inputs \texttt{5}, \texttt{7} and \texttt{13}, and we get the private key: \texttt{29}.

So \texttt{n=91}, public key \texttt{5}, private key \texttt{29}.

Let Alice and Bob know that \texttt{n=91}, Alice's public key is \texttt{5}, and her private key is \texttt{29}.

Bob wants to send a message to Alice: the message is \texttt{3}.

Then multiply \texttt{3} by itself \texttt{5} (public key) times, modulo \texttt{n=91}: \texttt{3*3*3*3*3=243}, \texttt{mod(243,91)=61}.

The public message is \texttt{61}.

By doing the opposite we can decode the message.

\begin{verbatim}
a=3; at=3;
for i=1:5-1
    at=mod(at*a,91)
end
Output=61.

a=61; at=61;
for i=1:29-1
    at=mod(at*a,91)
end
Output=3.
\end{verbatim}

We have decoded the message!

\begin{itemize}
	\item Alice and Bob know \texttt{n=91}.
	\item Everyone knows \texttt{5}.
	\item Only Alice knows \texttt{29}.
	\item Knowing \texttt{5} (public key) is not sufficient to decrypt the message.
	\item Can Bob trace Alice's private key? That is, is the information \texttt{91} sufficient to compromise security?
	\item Mathematical problem: factorization into prime numbers.
\end{itemize}

Prime factorization is not the most difficult problem on a bit-to-bit basis. Specialized algorithms such as Quadratic Sieve and General Number Field Sieve were created to address the factorization problem and have had some success. These algorithms are faster and less computationally intensive than the naive approach of guessing pairs of known primes.

These factoring algorithms become more efficient as the size of the numbers considered increases. The gap between the difficulty of factoring large numbers and multiplying large numbers narrows as the number (i.e. the key bit length) increases. As the resources available to decrypt the numbers increase, the size of the keys must grow even faster. This is not a sustainable situation for mobile and low-power devices that have limited computational power. The gap between factoring and multiplication is not sustainable in the long term.

All of this means that RSA is not the ideal system for the future of cryptography.

Techniques based on Elliptical Curves: \url{https://youtu.be/2RShPGAZqMs}.

Asymmetric algorithms guarantee confidentiality in communication. A message encrypted with the recipient's public key ensures that only the latter can decrypt this message, as it is the only one who has the corresponding private key.

Furthermore, by reversing the use of keys, that is, encrypting with the sender's private key and decrypting with the sender's public key, it is possible to guarantee authentication. It is on this principle that the digital signature is based.

The message is encrypted with the private key, so that anyone can, using the public key known by everyone, decrypt it and, in addition to being able to read it in clear text, be sure that the message was sent by the owner of the private key corresponding to the public one used to read it.

\section{What about miners?}

In addition to checking that the digital signatures of the transactions are authentic, that there is no double-spending, etc., and therefore verifying the transaction, their main job is to \textbf{build the Blockchain}, block by block. How? By concatenating the blocks together, this happens with the \textbf{solution of a computationally onerous mathematical problem}. If it were easily fixed, it would also be easy to \textbf{attack} the Blockchain.

\section{Proof of Work}

The Bitcoin Blockchain is therefore based on \textit{Proof of Work}.

Proof of Work, or PoW, is an algorithm that is used by different cryptocurrencies - such as Bitcoin and Ethereum - to reach a decentralized agreement between different nodes in the process of adding a specific block to the blockchain.

\textit{Hashcash (SHA-256)}\footnote{Visit this site to try some hashing: \url{https://emn178.github.io/online-tools/sha256.html}} is the Proof of Work feature used by Bitcoin. Cryptocurrency forces miners to solve extremely complex and computationally difficult mathematical problems to add blocks to the blockchain. This function produces a very specific type of data that is used to verify that a significant amount of work has been done.

A hash function takes an input of \textit{any} length and creates an output of \textit{fixed} length. 
\begin{equation*}
	\texttt{a0680c04c4eb53884be77b4e10677f2b}
\end{equation*}
This is referred to as the \textit{message digest}.

It is also known as the digital fingerprint.

Every transaction has a hash associated with it. In a block, all of the transaction hashes in the block are themselves hashed (sometimes several times, the exact process is complex), and the result is the Merkle root. In other words, the Merkle root is the \textit{hash of all the hashes of all the transactions in the block}. 

Our target is to \textbf{find a variation of it that SHA-256 hashes to a value beginning with `000'}. We vary the string by adding an integer value to the end called a \texttt{nonce} and incrementing it each time. Finding a match for ``Hello, world!'' takes us 4251 tries (but happens to have zeroes in the first four digits).

A PoW system \textbf{discourages attacks} and other abuse of service by enforcing certain jobs that require a computer's high processing time. A key feature of these works is their asymmetry: the work must be moderately, but easy to control.

Game theory: the nodes of the network compete with each other to register the new block thus obtaining compensation. Thanks to the expected remuneration, most of the nodes have an \textbf{interest in behaving in a \emph{legitimate} manner}, thus contributing to the growth of the blockchain.

\section{Proof of Stake}

Proof of Stake is an alternative method, a way by which nodes reach a consensus.

In the Proof of Stake consensus model, the number of digital currency tokens held by each user is an important issue within the system. The greater the stake (``stake''), i.e. the number of tokens owned by a user, the greater the chances that the system is not being breached. The more an individual is exposed to a cryptocurrency, the more likely they are to perform optimally.

The Proof of Stake blocks, unlike the Proof of Work blocks, are not mined, but minted. Participants who have a significant stake in Proof of Stake systems are selected on a pseudorandom basis to mint the blocks and add them to the blockchain.

\section{Uniqueness}

The chain is unique: if two different chains are created (for example, due to a delay in updating the blocks), the \textit{incorrect} one is automatically deleted and overwritten by the correct one.

To determine the correct chain, there are mechanisms: the chain considered correct is always the \textbf{longest one} (longest chain rule). \textbf{The blockchain rewards computational effort.}

Generally, the longest chain is also the one stored by the majority of the network nodes (50\%+1 rule), given that \textbf{miners are constantly incentivized to create valid blocks} through the fees and Bitcoins generated at each resolution of the mining problem. 

From a game theory perspective, collaborating on the longest chain is a balance, as no one can achieve a better result for themselves (without collaborating with others) by creating invalid blocks (PoWs). \textbf{This makes it very difficult for a hacker to change even the last block}.

\fg[An example of distributed consensus (or maybe not). \texttt{BTC Guild} can choose: \emph{longer chain rule»} vs. \emph{50\%+1 rule}.]{0.9}{c5d0d8444570c81ebcd5ac910f0741e7-HutyWMPv53-image}

\section{How the nodes get paid}

Who pays the nodes? \textbf{The system itself}. When a new block is added, besides the fees that people paid with the transactions inside it to incentivize the miner to add them to the block, the miner also receives a quantity from the system, meaning that \textit{everyone agrees} that they made enough computational effort. In other words, if everyone in the world suddenly decides to agree that you have a million dollars, even if you physically don't, you can go buy a Lamborghini, and then your fictitious money gets transferred to the company. It looks strange, but if you think about it, it's the process of printing virtual money for central governments to make inflation happen.

\fg{0.7}{d234ce63f4f4201295cf60ebe5083522-mZ9rNv3xhE-image}

\section{How much does it cost to produce a Bitcoin?}

Until a few years ago a good computer was enough to produce (mine) Bitcoin, today thousands of very powerful processors and graphics cards are needed.

For the extraction of Bitcoins, computers with specific processors called ASICs (application-specific integrated circuits) have been developed; these processors, in addition to having a high cost, also involve a \textbf{high consumption of electricity}.

It's \textit{not real-time} technology, it may take up to 1-2 hours to complete a transaction.

\section{Hashing and Notarization}

Notarization is a very useful \textbf{application} of the Blockchain. Suppose you want to prove that a certain document (a thesis for example) was ready on a given day.
\begin{itemize}
	\item The blockchain is like a ledger with a transaction order distributed among many entities where \textbf{only data can be added} and each one keeps an identical copy. Each register in the accounting book has a \textbf{time stamp}, is \textbf{immutable} and can be checked individually.
	\item Notarization: a hash containing the fingerprints of the files is recorded in the blockchain. All parties having access to the blockchain can individually verify the authenticity of these files.
\end{itemize}

How Does It Work? It is not possible to attach documents to the blockchain.
\begin{enumerate}
	\item The document is hashed. This means that the content of the document is \textit{summarized}, or better represented, by a string of 64 characters (256bit).
	\item The 64-character string is then put into a Bitcoin (or other) blockchain transaction using the \texttt{OP\_RETURN} \textbf{field}, it's a \textit{free} field presented in every Bitcoin transaction: free, but limited in size.
	\item A small Bitcoin payment is made to process the transaction and \textit{register it on the blockchain} (\textbf{you can also make a 0 BTC transaction}, so paying only the cost of the transaction - variable but around 0.00001 BTC).
\end{enumerate}

Hashing is \textit{irreversible} once you know the hash, it is \textit{mathematically impossible} to deduce the original text.

\textbf{Is it possible that two different files report the same Hash?}

The hash projects a (theoretically infinite) sequence of data, in a finite hash and is usually much shorter than the original file, so duplicates can happen. Possible, but \textit{very unlikely}! And, with the most advanced hashing techniques, it is difficult (if not impossible) to use this vulnerability (known as \textbf{Collision}) to modify documents for illegal purposes. And then there is the avalanche effect, a property where a small variation in input produces a considerable variation in the hash.

\section{Scalability}

It is not yet possible to think of a DLT that \textbf{completely replaces the system of financial transactions} (too large-scale). But it would be possible for two counterparties to create a DLT and use it for their transactions.

The cryptography used in Blockchain could certainly be considered to make current databases more secure.

Not just finance: The Blockchain can be used as a register in which to enter any type of information and consequently also a contract, an act or a certificate, avoiding the intermediation of third parties, but maintaining the guarantee of advertising.

Comparison of transactions capacity\footnote{\url{https://altcointoday.com/Bitcoin-ethereum-vs-visa-paypal-transactions-per-second/}}
\begin{itemize}
	\item Bitcoin – 3 to 4 transactions per second (1 block every 10 minutes);
	\item Ethereum – 20 transactions per second (1 block every 15 seconds);
	\item PayPal – 193 transactions per second average;
	\item Visa – 1.667 transaction per second.
\end{itemize}

PoW is \textbf{expensive:} it is the main cause of scalability problems (as well as memory problems: all nodes should store all transactions).

Solutions under study: off-chain operations, Proof of Stake, Proof of Work only on some random blocks, permissioned ledgers.

Permissioned ledgers (or private blockchains) can be controlled, and therefore can have ownership. When a new data or record is added to the blockchain, the approval system is not bound to the majority of participants but to a limited number of actors who can be defined as trusted.

\textbf{Three false myths?}
\begin{enumerate}
	\item Less expensive system
	      \begin{enumerate}
	      	\item Bitcoin transactions on the Blockchain cost (nearly) nothing.
	      	\item But this is possible because new Bitcoins are created for the remuneration of the network nodes that work for the proper functioning of the system.
	      \end{enumerate}
	\item Safer
	      \begin{enumerate}
	      	\item Potentially yes: safer in terms of immutability (less than 51\% attacks), but not privacy.
	      	\item The system of remuneration of the nodes pushes to use their own computing power to make the system work, not to try to force it.
	      	\item The database is distributed all over the world.
	      \end{enumerate}
	\item Faster
	      \begin{enumerate}
	      	\item The current financial transaction system is \textit{slow} not for a technological issue, but for a consensus issue.
	      	\item ``Consensus by reconciliation'': a process that the financial markets have chosen as their ``checks and balances'' system.
	      	\item It is, therefore, a question of moving to a new form of ``decentralized consensus'': an automatic mechanism that allows transactions to be quickly validated. Like in Bitcoin!
	      \end{enumerate}
\end{enumerate}

Read here to see how to verify a block on the blockchain!

{\scriptsize\url{https://blockchain-academy.hs-mittweida.de/courses/blockchain-introduction-technical-beginner-to-intermediate/lessons/lesson-13-Bitcoin-block-hash-verification/topic/how-to-calculate-and-verify-a-hash-of-a-block/}}

\chapter{Cryptoassets (D. Marazzina)}

A \textbf{cryptoasset} (coin) is a financial asset that is created and exchanged on a platform; like a blockchain, but not only a blockchain.

Assets are divided into
\begin{itemize}
	\item \textbf{cryptocurrencies:} the native currency of the blockchain (Bitcoin)
	\item \textbf{tokens:} crypto asset not native of the technology
\end{itemize}

Is Bitcoin a token? Not exactly. While all cryptocurrencies are technically tokens, Bitcoin is usually not considered a token, but a coin. This is because it is generated by the blockchain that supports it. Tokens, on the other hand, operate on existing blockchains. In fact, a single blockchain offers space for \textbf{many different tokens}. Suffice it to say that the Ethereum network currently hosts almost half a million.

It's not easy to \textit{diversify} cryptoassets because correlation is very high.

USDT and USDC are very stable.

It may happen that there are so called \textbf{forks} on the Blockchain:
\begin{itemize}
	\item \textbf{Soft fork:} when there are two versions of the Blockchain and it's solved automatically.
	\item \textbf{Hard fork:} when something (a software update that only some install) creates two versions of the Blockchain.
\end{itemize}

\paragraph*{Bitcoin Cash.}

It's a cryptocurrency that is a fork of Bitcoin that was created in 2017:
\begin{itemize}
	\item On 21 July 2017 Bitcoin miners locked in a software upgrade referred to as \textbf{Bitcoin Improvement Proposal (BIP) 91: the Segregated Witness (Consensus layer).}
	\item SegWit alleviates the scaling problem by enabling the Lightning Network, an overlay network of micropayment channels, hypothetically resolving the scaling problem by enabling virtually unlimited numbers of instant, low-fee transactions to occur \textit{off chain}.
	\item By 8 August 100\% of the Bitcoin mining pools signaled support for SegWit.
	\item A small group of mostly China-based Bitcoin miners, that were unhappy with Bitcoin's proposed SegWit improvement plans, pushed forward alternative plans for a split which \textbf{created Bitcoin Cash}. The proposed split included a plan to increase the number of transactions its ledger can process by increasing the block size limit.
\end{itemize}

In 2018 Bitcoin Cash subsequently split into two cryptocurrencies: Bitcoin Cash, and Bitcoin SV.

\paragraph*{Bitcoin SV.}
\begin{itemize}
	\item On 15 November 2018, a hard fork chain split of Bitcoin Cash occurred between two rival factions called Bitcoin Cash and Bitcoin SV.
	\item The split originated from what was described as a \textit{civil war} in two competing Bitcoin cash camps.
	\item The first camp promoted the software entitled Bitcoin ABC (short for Adjustable Blocksize Cap) which would maintain the block size at 32 MB.
	\item The second camp put forth a competing software version Bitcoin SV, short for \emph{Bitcoin Satoshi Vision}, that would increase the block size limit to 128 MB.
\end{itemize}

\paragraph*{Bitcoin Gold.}
Another hard fork of Bitcoin.
\begin{itemize}
	\item Bitcoin Gold is a fork of Bitcoin that seeks to reduce the influence of miners who use specialized equipment known as ASICs. The team’s stated goal is to ``make Bitcoin decentralized again.''
	\item Bitcoin Gold hard forked from the Bitcoin blockchain on October 24, 2017.
	\item In May 2018, Bitcoin Gold was hit by a 51\% hashing attack by an unknown actor. This type of attack makes it possible to manipulate the blockchain ledger on which transactions are recorded and to spend the same digital coins more than once. During the attack, 388,000 BTG (worth approximately \$18 million) was stolen from several cryptocurrency exchanges. 
	\item Bitcoin Gold suffered from 51\% attacks again in January 2020\footnote{{\scriptsize\url{https://thenextweb.com/hardfork/2020/01/27/Bitcoin-gold-51-percent-attack-blockchain-reorg-cryptocurrency-binance-exchange/}}}.
\end{itemize}

\textit{Interesting example.}

TheDAO (Decentralized Autonomous Organization), an automated investment fund, entirely managed by computers and based on blockchain technology: it has raised over 150 million dollars in the short period in which it was open to public subscription.

An individual or group of individuals found a flaw in the smart contract to steal funds from the \textit{cash} of the TheDAO.

The software platform was launched on May 28, 2016.

On Friday 17 June, funds were subtracted thanks to a \textit{badly thought line of code} that allowed funds belonging to TheDAO to be subtracted.

If \textit{code-is-law}, is this subtraction illegal?

If the blockchain is immutable, how can it be canceled?

Two solutions:
\begin{itemize}
	\item A Soft Fork is an operation that updates Ethereum's functionality while maintaining backward compatibility.
	\item A Hard Fork, on the other hand, is an update of the protocol that makes old versions of Ethereum obsolete.
\end{itemize}

A hard fork was made, and the blockchain was rewritten by eliminating the transaction.

How? With distributed consent! More than 50\% of Ethereum users have accepted the update. This is why now there exists Ethereum Classic, almost abandoned.

\textbf{Distributed consent overcomes the immutability of the Blockchain.}

\section{Stablecoins}

\fg{0.7}{bdcc146817b36f24613f0c0967a7d1f9-1ruH8716er-image}

\fg{0.7}{7dc3967046522e1c02d9c1916fa87f9b-DMNNfblLZC-image}

\fg{0.7}{49d147896a4ef0b2ca9045ac755abe65-Sx4PA1dE8U-image}

A \textbf{stablecoin} is a new class of cryptocurrencies that attempts to offer \textbf{price stability} and is backed by a reserve asset. 

Stablecoins have gained traction as they attempt to offer the best of both worlds—the instant processing and security or privacy of payments of cryptocurrencies, and the volatility-free stable valuations of fiat currencies.

Usually, one token of stablecoin equals one gram of gold. Since they’re tied to the gold, this stablecoin’s price can’t fall below the current price of the gold. A third party holds the gold in reserve.

\begin{itemize}
	\item Libra
	\item Tether
	\item MakerDAO is a protocol behind the stable coin DAI — a cryptocurrency that maintains a 1:1 peg to the USD. 
\end{itemize}

\section{ICO}

It's a utility token.

The biggest disadvantage of an ICO investment is the risk. The market is volatile, and you never know the actual intentions of a newly minted company. The first risk can be called ordinary fraud when the team of the project pursues only one goal: to collect investors' money. In addition, since there are no laws at the moment that would regulate the conduct of cryptocurrency crowd sales from the position of an investor, it cannot be ruled out that the project may not live to the stage of product appearance or disappoint the investor with its implementation. Based on the statistical research provided by Satis Group, a premier ICO advisory company, approximately $81\%$ of ICOs are Scams, $\sim 6\%$ Failed, $\sim 5\%$ had Gone Dead, and $\sim 8\%$ went on to trade on an exchange.

According to the evaluation of the Wall Street Journal, due to fraudulent crowdfunding campaigns, token holders have lost more than a billion dollars. One of the main reasons for such statistics might be the lack of token holders' control over their investments and the absence of bills and laws regulating the legal field in the sphere of ICO.

The other serious threat is hackers' attacks. Research, conducted by Ernst\&Young (2017), showed that more than $10\%$ of all funds raised by ICO were stolen by cybercriminals. Analysts examined 372 ICOs conducted between 2015 and 2017. The monthly amount of losses from hackers in an ICO is $\$1.5$ million. Moreover, attackers often manage to gain access to personal data from investors: from their addresses and phone numbers to billing information. This vulnerability of ICO is usually caused by errors in the code of the smart contract which weren't indicated during the audit.

\subsection{Security Token Offerings (STO)}

\begin{itemize}
	\item The popular utility tokens used in ICO have the main disadvantage, which is the absence of any compensation for investors in case of ICO fails as utility tokens are not security papers leading to the absence of any obligations for making beneficial conditions for investors. 
	\item The decision to this challenge is a security token. Security tokens represent real capital in the enterprise, at the same time such token is not necessarily tied to a share in the company, it can be used to divide the rights of the ownership. They may give the holder several rights: ownership of shares, periodic dividends, cashflows, payment of debts, the right to vote, etc. All these rights are secured by a smart contract. Due to the features of these tokens, their value is supported by securities, therefore, they are considered an investment. 
	\item The issue of security tokens requires serious supervision by regulatory authorities. This supervision leads to the protection of investments and gives investors more rights, thus restoring the balance of power from the point of view of stakeholders 
	\item Security token offering (STO) is the initial offer of security tokens. STO is similar to ICO in one thing: both issue tokens for investors. The main reason for buying securities tokens is dividends or voting rights.
	\item STO project meets all the requirements of the SEC means that investor's money is protected by law. In case of disputes, the investor can file a complaint with the appropriate authority since this type of token falls under the legislation on securities 
\end{itemize}

\fg{0.7}{1285a6b75181acc02dbcae61b217a6bc-0Z4VUukkZi-image}

\section{Asset allocation}

First 50 stocks for capitalization (S\&P50)

4 cryptocurrencies
\begin{itemize}
	\item BITCOIN
	\item ETHEREUM
	\item RIPPLE
	\item LITECOIN
\end{itemize}

Period: July 2015-May 2019

\fg{0.7}{a091830eaba227339add9fbe000a7964-Xjp2TOr5Gl-image}

Correlation

\fg{0.7}{a9628e77047a0bb29a84c79a86340735-oczvbgskgs-image}

\section{Central Bank Digital Currency}

\texttt{[08-CBDM.pptx]}

\chapter{Blockchain (N. C. Fabrizio)}

\section{Intro to DTL}

Bitcoin is the mother of all the blockchains. It's constructed around the idea of having a \textbf{ledger} where we track information. Typically there is a \textbf{central} authority which holds the only copy of it and is the only one allowed to modify it.

A distributed ledger is a \textbf{tamperproof} sequence of data that can be \textbf{read} and \textbf{augmented} by \textbf{everyone}. Nodes don't need to \textbf{trust} each other, the mechanism of \textbf{consensus} (a combination of game theory and probability) removes the need for it, and everyone has an interest in behaving as the blockchain requires. 

DLT: which desirable properties?
\begin{itemize}
	\item Immutability
	\item Accessibility
	\item Decentralisation
\end{itemize}

\section{Bitcoin Protocol}

Blockchain: a data structure to record information incrementally (a history). An append-only data structure, a growing chain of blocks, with immutable history: what is written cannot be altered.

It's maintained by a \textbf{peer-to-peer} open network of nodes: anyone can join! Identical replicated copies of the ledger/blockchain, \textbf{openly available}: anyone can read, \textbf{true by majority}.

PoW slows and controls the creation of new blocks, in this way you can't change the blockchain previously and have the time to re-calculate all hashes, because the chain will grow and the longest chain always wins (except with hard-forks).

No one is in charge, but the whole community.

Problem: how does the community select someone in charge to write the next block?

Who writes the next sentence?

In our case, whoever writes the next sentence gets \numprint{100000} EUR!

Who writes the next sentence?

Proof of Work! This is the solution adopted by the Bitcoin blockchain: by controlling the difficulty of the challenge (against the available computational power in the network), it is possible to select, with a reasonable probability, a leader in charge of the next sentence/block. Note that the challenge is difficult to solve, i.e. find 431 and 433, but easy to validate, i.e. multiply them and check the result: difficult to be elected, straightforward to be recognized as a leader.

\paragraph*{Bitcoin mining protocol [Nakamoto08]}
Each node of the Bitcoin network will
\begin{itemize}
	\item choose and verify pending transactions
	\item solve the crypto-puzzle (depending on the previous block)
\end{itemize}

If solved/leader then
\begin{itemize}
	\item create the next block and
	\item broadcast the new block
\end{itemize}

Everyone
\begin{itemize}
	\item validate new block (Proof of Work + transactions) and embed it in the local copy of the blockchain
	\item start mining the next block
\end{itemize}

The blockchain is actually a tree, including \emph{the} chain.

Currently, a block is about 1 MB and is added every 10 minutes (for an average of 3-7 trans/sec).

If a node wants to change an old block, or in general wants to make the chain take a direction he wants, he would need half as much the computational power of the network to keep up with the others. This is considered to be impossible, and everyone has an advantage in sticking with the same version.

\section{Security aspects}

\subsection{Hash functions}

\paragraph*{Hashes.} Are functions: $H(a)=h$ such that:
\begin{itemize}
	\item from $a$ to $h$ is easy, but from $h$ to $a$ computationally infeasible (you should try every possible input);
	\item $a$ can be of any length (thus could even be a document) but $h$ is fixed by the specific hash function chosen.
\end{itemize}

\textbf{Properties:}
\begin{itemize}
	\item \textbf{Collision resistance}, it's infeasible to find $a$ and $b$ such that $a\neq b$ and $H(a)=H(b)$
	\item \textbf{Hiding}, when a secret value $r$ is chosen from a probability distribution that has high entropy, then given $H(r\mid x)$ it is infeasible to find $x$. ``$\mid$'' means concatenation of two strings.
	\item \textbf{Puzzle friendliness}, given $h$ and a random $k$, it's unfeasible to find $x$ such that $h=H(k\mid x)$.
\end{itemize}

\subsection{Merkle tree}

Some desirable properties of a (new) block
\begin{itemize}
	\item follows linearly (and exclusively) the previous one - links to the previous block
	\item the set of transactions is fixed before leader election - Merkle tree. against corruption
	\item the leader is identified – as the solver of the puzzle
\end{itemize}

\paragraph*{Merkle tree.} Is a digest of digests, i.e. a tree, a compact representation of a set of hashes of Bitcoin transactions, amongst the proposed and selected ones. The root represents all the hashes in the tree and any change anywhere would affect the root.
\begin{itemize}
	\item Transactions are hashed two by two until the root, which is like the DNA of the block.
	\item In other words, a Merkle tree summarizes all the transactions in a block by producing a digital fingerprint of the entire set of transactions, thereby enabling a user to verify whether or not a transaction is included in a block.
	\item It is possible to \textbf{verify that a transaction belongs to a block without verifying all the blocks.}
	\item Thanks to this structure, it is quicker and more efficient to verify the consistency and content of the data
\end{itemize}

\fg{0.7}{a4e440abba339ed859d31f59f5a84ad6-6M8F4XuJr8-image}

\subsection{Proof of Work}

\paragraph*{Proof of Work} (at a certain degree of approximation) is finding \texttt{nonce} (number only used once) such that 
\begin{equation*}
	H(H(\text{previous block}),M(\text{transactions} +\text{revenue transaction}),\texttt{nonce})
\end{equation*}
is an hash starting with $C$ zeros. $M$ is the Merkle Root of the input transaction and the reward transaction. $C$ controls the complexity and adapts regularly. There are some technical details involved, like the fact the timestamps are also hashed, everything has to be converted to hexadecimal and the hash is made two times.

PoW is very expensive in terms of energy consumption.

Miners have interest in solving this hard problem because they are rewarded:
\begin{itemize}
	\item the fees from each transaction;
	\item an amount of BTC generated (mined), in other words, everyone suddenly agrees that such miner has that quantity in addition to their wallet. The quantity was initially 50 BTC and is halved every \numprint{210000} blocks; currently, it's 6.25 BTC. This mechanisms guarantees that in circulation there will never be more than
	\begin{equation*}
		\numprint{210000} \cdot (50+25+12.5+6.25+\cdots) = \numprint{21000000}\ \text{BTC}
	\end{equation*}
\end{itemize}

\subsection{Public and private keys}

Asymmetric\footnote{\textit{asymmetric} means that the two keys are different.} cryptography is based on two keys associated with an identity:
\begin{itemize}
	\item a private (secret) key $sk$, known only by the owner. It is generally used to encrypt a message by the owner, $sk\{m\}$
	\item a public key $pk$ associated to the identity and public. It can decrypt a message encrypted with $sk$, i.e. $pk\{sk\{m\}\} =m$ and also $sk\{pk\{m]\} =m$.
\end{itemize}

\textbf{Properties}
\begin{itemize}
	\item one way function: unfeasible from $sk\{m\}$ to get $m$ without $pk$, easy with $pk$.
	\item with $n$ nodes, only $n$ pairs ($pk_{i}$,$sk_{i}$) are needed instead of $n^{2}$
	\item anyone can secretly send to $j$ by using $pk_{j}\{m\}$
	\item $j$ can prove that they own a piece of information by using $sk_{j}\{m\}$
\end{itemize}

Signature of a message (of a transaction) – on top of asymmetric cryptography:
\begin{itemize}
	\item $sig:=sign(sk,\text{message})$
	\item $isValid:=verify(pk,\text{message},sig)$
\end{itemize}

Using the public key $pk$ one can validate the author of a message (transaction!)

How is asymmetric cryptography is used in Bitcoin?

You generate your own private key from a very large set, from there you derive your public key, and from the public key, an address can be derived by hashing.

\fg{0.7}{f468dea48fcab290a0d662d26e78de02-t8qu0CuuVm-image}

Bitcoin transactions move value from multiple input addresses to multiple output addresses.

\subsection{Encryption with Elliptic Curves}

In algebraic geometric, an elliptic curves (EC) over $\mathbb{R}$ is defined by the (Weirstrass’s equation): $y^{2} =x^{3} +ax+b$. The curve is non singular if its determinant is non zero, which means $4a^{3} +27b^{2} \neq 0$.

Bitcoin uses EC for public key, it uses a famous EC \textbf{secp256k1}:
\begin{equation*}
	y^{2} =x^{3} +7
\end{equation*}

\url{https://youtu.be/muIv8I6v1aE}

\url{https://youtu.be/qCafMW4OG7s}

Bitcoin uses elliptic curves for public keys.

\section{Structure of a Block}

A block has two main components:
\begin{itemize}
	\item \textbf{list of transactions};
	\item \textbf{block header}, which contains:
	\begin{itemize}
		\item \texttt{Version}: Block version number
		\item \texttt{Previous Block hash}: This is used to compute a new block hash. Hence, making the blockchain temper-proof.\footnote{The first block doesn't have any previous one, it's called the \textbf{genesis block}.}
		\item \texttt{Merkle Tree Root}: The root of the Merkle tree is a verification of all the transactions.
		\item \texttt{Timestamp}: The time at which block is mined.
		\item \texttt{Bits/Difficulty}: Difficulty in Bitcoin is expressed by the hash of a Bitcoin block header being required to be numerically lower than a certain target.
		\item \texttt{Nonce}: A 32-bit random number used in blockchain, while calculating the cryptographic hash for a Block.
	\end{itemize}
\end{itemize}

\section{Public, Hybrid and Private DLT}

The ledger, replicated on each node, may be \textbf{public}, \textbf{private} or \textbf{hybrid}.

The network maybe \textbf{permissionless} or \textbf{permissioned}.

\textbf{Public}
\begin{itemize}
	\item No one is in charge
	\item Anyone can participate 
	\item Open and transparent
	\item Decentralized consensus mechanisms (PoW, PoS, ...)
	\item Mining
	\item Slow
\end{itemize}

\textbf{Hybrid}
\begin{itemize}
	\item Multiple selected organizations
	\item Permissioned known identities
	\item Pre-approved participants
	\item Voting/multi- party consensus
	\item Lighter and faster
\end{itemize}

\textbf{Private}
\begin{itemize}
	\item Private property of an
	\item individual or an organization
	\item Permissioned known identities
	\item Pre-approved participants
	\item Voting/multi- party consensus
	\item Lighter and faster
\end{itemize}

\fg{1}{0ab69fc7ee15e9b5efb04bb8d39299ab-2lIIJXa4gj-image}

In general, every blockchain has its token.

\section{Ethereum}

Ethereum is an \textbf{open-source} and public blockchain-based \textbf{distributed computing platform for building decentralized applications}. Vitalik Buterin envisioned Ethereum as a platform for developers to write programs on the blockchain. In short, Ethereum wants to be a \textbf{World Computer} that would decentralize – and some would argue, democratize – the existing client-server model. With Ethereum, servers and clouds are replaced by thousands of so-called ``nodes'' run by volunteers from across the globe (thus forming a ``world computer'').

\textbf{Smart contracts} are simple programs stored on the blockchain that automatically exchange money based on certain conditions.

A contract that self-executes, and handles the enforcement, the management, performance, \& payment. You would require tokens for executing a smart contract as well as for trading. So basically, Ethereum is incomplete without cryptocurrency. The language is \textit{Turing-complete}, meaning it supports a broader set of computational instructions.

Smart contracts can:
\begin{itemize}
	\item Function as \textit{multi-signature} accounts, so that funds are spent only when a required percentage of people agree
	\item Manage agreements between users, say if one buys insurance from the other
	\item Provide utility to other contracts (similar to how a software library works)
	\item Store information about an application, such as domain registration information or membership records.
\end{itemize}

Ethereum runs on its native token (\textbf{Ether}) which serves two main purposes:
\begin{itemize}
	\item Ether payment is \textbf{required for applications to perform any operation} so that broken and malicious programs are kept under control.
	\item Ether is \textbf{rewarded as an incentive to the miners who contribute to the Ethereum network} with their resources - much like Bitcoin’s structure.
\end{itemize}

Every time a contract is executed, Ethereum consumes a token which is termed as \textbf{gas} to run the computations. Gas is required to be paid for every operation performed on the Ethereum blockchain. Its price is expressed in ether and it’s decided by the miners, which can refuse to process the transaction with less than a certain gas price.

\textbf{Examples}\footnote{\url{https://medium.com/coreledger/what-are-smart-contracts-a-breakdown-for-beginners-92ac68ebdbeb}}
\begin{itemize}
	\item A smart contract could be programmed to release funds for someone’s birthday each year. It could also be programmed to release payment once someone confirms receipt of delivered goods. It could be used to enforce particular rights for holders of digital assets.
	\item A simple example could be in the case of \textbf{life insurance}. The policy terms would be encoded into the smart contract. In the event of a passing, the notarized death certificate would be provided as the input trigger for the smart contract to release the payment to the named beneficiaries.
\end{itemize}

\paragraph{Oracle} A blockchain oracle is a third-party service that connects smart contracts with the outside world, primarily to feed information in from the world, but also the reverse. Information from the world encapsulates multiple sources so that decentralised knowledge is obtained. Information to the world includes making payments and notifying parties. The oracle is the layer that queries, verifies, and authenticates external data sources, usually via trusted APIs, proprietary corporate data feeds and internet of things feeds and then relays that information.

\section{Ethereum vs. Bitcoin}

While both the Bitcoin and Ethereum networks are powered by the principle of distributed ledgers and cryptography, the two differ technically in many ways. For example, \textbf{transactions on the Ethereum network may contain executable code, while data affixed to Bitcoin network transactions are generally only for keeping notes.}

Both Bitcoin and Ethereum currently use a consensus protocol called Proof of Work (PoW), which allows the nodes of the respective networks to agree on the state of all information recorded on their blockchains and prevent certain types of economic attacks on the networks. In 2022, \textbf{Ethereum will be moving to a different system called Proof of Stake (PoS)} as part of its Eth2 upgrade, a set of interconnected upgrades that will make Ethereum more scalable, secure, and \textbf{sustainable}.

Proof of Stake substitutes computational power with staking—making it less energy-intensive—and replaces miners with validators, who stake their cryptocurrency holdings to activate the ability to create new blocks.

While Bitcoin was created as an alternative to national currencies and thus aspires to be a medium of exchange and a store of value, \textbf{Ethereum was intended as a platform to facilitate immutable, programmatic contracts and applications via its own currency}.

\section{Ethereum moving to Proof of Stake}

Ethereum has announced the launch of 2.0 and the process of moving to Proof

of Stake (may be completed and happen soon)
\begin{itemize}
	\item This approach does not require large expenditures on computing and energy, it will change the need for CPUs for mining
	\item Miners are now ``validators'' and post a deposit in an escrow account
	\item The more escrow you post, the higher the probability you will be chosen to nominate the next block
	\item If you nominate a block with invalid transactions, you lose your escrow
	\item One issue with this approach is that those that have the most Ethereum will be able to get even more
	\item This leads to centralization eventually
	\item On the other hand, it reduces the chance of a 51\% attack and allows for near-instant transaction approvals
	\item The protocol is called Casper and this will be a hard fork
\end{itemize}

\section{Dapps}

\begin{itemize}
	\item \textbf{Decentralized Applications (Dapps)} are computer applications that operate over a blockchain enabling direct interaction between end-users and providers.
	\item \textbf{The interface of the decentralized applications does not look any different than any website or mobile app today.}
	\item The \textbf{smart contract represents the core logic} of a decentralized application. Smart contracts are integral building blocks of blockchains, that process information from external sensors or events and help the blockchain manage the state of all network actors.
\end{itemize}

\section{ERC20}

\begin{itemize}
	\item First token standard
	\item Introduced in November 2015 as an Ethereum Request for Comments (ERC)
	\item Automatically assigned GitHub issue number 20, giving rise to the name ``ERC20''
	\item A standard for fungible tokens, meaning that different units of an ERC20 token are interchangeable and have no unique properties
	\item The ERC20 protocol standard contains basic functions that any useful token should implement to enable trading. These include transferring tokens, inquiring about the balance of tokens at a certain address, and the total supply of tokens.
	\item The ERC-20 standard defines the interfaces for a few common methods: i.e. totalSupply, balanceOf, transfer, transferFrom, and approve. These methods allow Ethereum smart contracts to issue fungible tokens and token holders to transfer tokens to one another.\footnote{\url{https://eips.ethereum.org/erc}}
	\item Today, there are thousands and thousands of ERC20 tokens (derivatives of ETH), almost in every sector and use case, not only in finance (for a list see Etherscan and select ERC20)
\end{itemize}
